(function(){var a,b,c,d,e;a=jQuery,a.fn.extend({dropdown:function(c){var f,g;f={slide:!0,classes:!1,template:e},g=a.extend({},f,c);return this.each(function(){var c,e;e=a(this),c=d(e,g),b(e,c,g);return e.trigger("dropdown.refresh")}).next()}}),e=function(a){var b;b=a?" "+a:"";return"  <div class='dropdown-container"+b+"'>    <span class='dropdown-header'>    <span class='dropdown-current' />      <a href='javascript:;' class='dropdown-expand'>&darr;</a>    </span>    <div class='dropdown-items'>      <ul />    </div>  </div>"},c=function(b){var c;b=a(b),c=a("<a />",{href:"javascript:;","data-value":b.val(),text:b.text()});return a("<li />",{"class":"dropdown-entry","data-value":b.val()}).append(c)},d=function(b,c){return a(c.template(c.classes)).insertAfter(b.hide())},b=function(b,d,e){a(document).bind("click",function(){return d.trigger("dropdown.hide")}),d.delegate(".dropdown-entry","click.dropdown",function(){return d.trigger("dropdown.select",a(this).attr("data-value"))}),b.bind("dropdown.refresh",function(){var a;a=d.find("ul").empty(),b.find("option").each(function(){return a.append(c(this))});return d.trigger("dropdown.select",b.find(":selected").val())}),d.bind("dropdown.select",function(a,c){var e,f;f=d.find("a[data-value="+c+"]"),e=d.find(".dropdown-current"),e.text(""),b.val(""),f.size()&&(e.text(f.text()),b.val(c),f.addClass("selected"));return d.trigger("dropdown.hide")}),d.bind("dropdown.move",function(){var a,b;a=d.find(".dropdown-items"),b=function(){return d.toggleClass("expanded")};return e.slide?a.slideToggle(b):a.fadeToggle(b)}),d.bind("dropdown.hide",function(){var a,b;a=d.find(".dropdown-items"),b=function(){return d.removeClass("expanded")};return e.slide?a.slideUp(b):a.fadeOut(b)});return d.delegate(".dropdown-current, .dropdown-expand","click",function(a){a.stopPropagation(),a.preventDefault();return d.trigger("dropdown.move")})}}).call(this)